<div class="anime-grid">
    {% for item in anime_list %}
        {# –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –±–ª–æ–∫: —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ —Å –æ–±—ä–µ–∫—Ç–æ–º Anime, –∏ —Å –∑–∞–ø–∏—Å—å—é UserAnimeList #}
        {# –ï—Å–ª–∏ item.anime —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—ç—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞), –±–µ—Ä–µ–º –µ–≥–æ. –ï—Å–ª–∏ –Ω–µ—Ç, —Å—á–∏—Ç–∞–µ–º item —Å–∞–º–∏–º –∞–Ω–∏–º–µ. #}
        {% with anime=item.anime|default:item status=item.status %}

        <a href="{% url 'anime_detail' slug=anime.code %}" class="anime-card" data-name="{{ anime.name_ru|lower }}">

            <div class="poster-wrapper loading">
                {% if anime.poster_path %}
                    <img src="{{ anime.poster_path }}"
                         alt="{{ anime.name_ru }}"
                         loading="lazy"
                         onload="this.parentElement.classList.remove('loading')">
                {% else %}
                    <div class="no-poster"><span>–ù–µ—Ç —Ñ–æ—Ç–æ</span></div>
                {% endif %}
                <div class="card-overlay"><span class="play-icon">‚ñ∂</span></div>
            </div>

            <div class="card-info">
                <h3 class="card-title">{{ anime.name_ru }}</h3>

                <div class="card-meta">
                    {# –ï—Å–ª–∏ –µ—Å—Ç—å —Å—Ç–∞—Ç—É—Å (—Å–º–æ—Ç—Ä—é/–±—Ä–æ—à–µ–Ω–æ), –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ü–≤–µ—Ç–Ω—É—é —Ç–æ—á–∫—É #}
                    {% if status %}
                        <span class="status-dot {{ status }}"></span>
                    {% endif %}

                    {# –¢–≤–æ—è –¥–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è #}
                    {% if item.updated_at %}
                        <span class="date-badge">{{ item.updated_at|date:"d.m.Y" }}</span>
                    {% endif %}
                </div>

                {# –¢–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ #}
                {% if anime.description %}
                    <p class="card-desc">{{ anime.description|striptags|truncatechars:70 }}</p>
                {% endif %}
            </div>
        </a>
        {% endwith %}

    {% empty %}
        {# –ë–ª–æ–∫ –ø—É—Å—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è #}
        <div class="empty-state">
            <span class="empty-icon">üìÇ</span>
            <h3>{{ empty_msg|default:"–ó–¥–µ—Å—å –ø–æ–∫–∞ –ø—É—Å—Ç–æ" }}</h3>
            <p>–î–æ–±–∞–≤—å—Ç–µ –∞–Ω–∏–º–µ –≤ —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–æ—Å–º–æ—Ç—Ä–∞.</p>
            <a href="{% url 'home' %}" class="browse-btn">–ù–∞–π—Ç–∏ –∞–Ω–∏–º–µ</a>
        </div>
    {% endfor %}
</div>
